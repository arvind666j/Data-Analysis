---Average Selling Price

select P.product_id,IFNULL(ROUND(sum(p.price*u.units)/sum(u.units),2),0) as average_price from Prices P left join UnitsSold u on P.product_id=U.product_id AND u.purchase_date between p.start_date and p.end_date group by p.product_id
